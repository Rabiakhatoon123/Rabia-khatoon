CREATE DATABASE INSURANCE1;
USE INSURANCE1;

CREATE TABLE PERSON(DRIVERID VARCHAR(50) PRIMARY KEY,
    NAME VARCHAR(100),
    ADDRRESS VARCHAR(255));
    
    
CREATE TABLE CAR( REGNO VARCHAR(50) PRIMARY KEY,
    MODEL VARCHAR(100),
    YEAR INT);
    
    
CREATE TABLE ACCIDENT(REPORTNUMBER INT PRIMARY KEY,
    ACCIDENTDATE DATE,
    LOCATION VARCHAR(255));
    
    
CREATE TABLE OWN(DRIVERID VARCHAR(10),
    REGNO VARCHAR(15),
    PRIMARY KEY (DRIVERID, REGNO),
    FOREIGN KEY (DRIVERID) REFERENCES PERSON(DRIVERID),
    FOREIGN KEY (REGNO) REFERENCES CAR(REGNO));
    
    
CREATE TABLE PARTICIPATED( DRIVERID VARCHAR(10),
    REGNO VARCHAR(15),
    REPORTNUMBER INT,
    DAMAGEAMOUNT INT,
    PRIMARY KEY (DRIVERID, REGNO, REPORTNUMBER),
    FOREIGN KEY (DRIVERID) REFERENCES PERSON(DRIVERID),
    FOREIGN KEY (REGNO) REFERENCES CAR(REGNO),
    FOREIGN KEY (REPORTNUMBER) REFERENCES ACCIDENT(REPORTNUMBER));
    
    
INSERT INTO PERSON
VALUES
('D001', 'John Doe', '123 Main Street'),
('D002', 'Jane Smith', '456 Elm Street'),
('D003', 'Michael Johnson', '789 Oak Street'),
('D004', 'Emily Brown', '101 Pine Street'),
('D005', 'David Wilson', '234 Maple Street');


INSERT INTO CAR(REGNO, MODEL, YEAR)
 VALUES
('ABC123', 'Toyota Camry', 2019),
('XYZ456', 'Honda Civic', 2018),
('DEF789', 'Ford Mustang', 2020),
('GHI101', 'Chevrolet Silverado', 2017),
('JKL234', 'Nissan Altima', 2016);


INSERT INTO ACCIDENT 
 VALUES
(1001, '2024-01-10', 'Intersection of Main St and Elm St'),
(1002, '2024-02-15', 'Highway 101'),
(1003, '2024-03-20', 'Parking Lot of Supermarket'),
(1004, '2024-04-25', 'Residential Area'),
(1005, '2024-05-30', 'Downtown Area');

INSERT INTO OWN  VALUES
('D001', 'ABC123'),
('D002', 'XYZ456'),
('D003', 'DEF789'),
('D004', 'GHI101'),
('D005', 'JKL234');

INSERT INTO PARTICIPATED  VALUES
('D001', 'ABC123', 1001, 5000),
('D002', 'XYZ456', 1002, 3000),
('D003', 'DEF789', 1003, 2000),
('D004', 'GHI101', 1004, 4000),
('D005', 'JKL234', 1005, 2500);

UPDATE PARTICIPATED
SET DAMAGEAMOUNT= 25000
WHERE REGNO = 'Your_Regno_Here' AND REPORTNUMBER = 12;

INSERT INTO ACCIDENT VALUES (15, '2024-03-25', 'Intersection of 2nd St and Elm St');


SELECT COUNT(DISTINCT p.DRIVERID) AS total_people_involved
FROM PERSON p
JOIN OWN o ON p.DRIVERID = o.DRIVERID
JOIN CAR c ON o.REGNO = c.REGNO
JOIN PARTICIPATED pt ON o.DRIVERID = pt.DRIVERID AND o.REGNO = pt.REGNO
JOIN ACCIDENT a ON pt.REPORTNUMBER = a.REPORTNUMBER
WHERE c.YEAR = 2008; -- Assuming 'year' column in CAR represents the manufacturing year


SELECT COUNT(DISTINCT a.REPORTNUMBER) AS num_accidents
FROM CAR c
JOIN OWN o ON c.REGNO = o.REGNO
JOIN PARTICIPATED p ON o.DRIVERID = p.DRIVERID AND o.REGNO = p.REGNO
JOIN ACCIDENT a ON p.REPORTNUMBER = a.REPORTNUMBER
WHERE c.MODEL = 'YourSpecificModel';